{"version":3,"sources":["reports/completion.js"],"names":["define","$","Notification","common","CFG","SELECTOR","PAGE","EXPORT","COHORT","COURSE","GROUP","EXCLUDE","INACTIVE","PROGRESS","GRADE","LENGTH","SEARCH","PAGETITLE","FORMFILTER","DATE","DATEMENU","DATEITEM","DATEPICKER","DATEPICKERINPUT","filter","cohort","course","group","exclude","enrolment","inactive","progress","grade","flatpickr","dataTable","PROMISES","GET_DATA","ajax","url","requestUrl","type","requestType","dataType","requestDataType","data","action","sesskey","M","local_edwiserreports","secret","lang","attr","JSON","stringify","initializeDatatable","loader","show","find","val","statuses","concat","util","get_string","never","done","response","destroy","text","name","DataTable","dom","pageLength","deferRendering","language","info","infoEmpty","emptyTable","zeroRecords","paginate","previous","next","columnDefs","className","targets","columns","render","width","formatDate","Date","timeFormatter","drawCallback","stylePaginationButton","this","initComplete","hide","search","page","len","draw","fail","ex","exception","reloadFilter","types","callback","_init","CONTEXTID","updateTimeLabel","handleSearchInput","not","select2","placeholder","allowClear","mode","altInput","altFormat","dateFormat","maxDate","appendTo","get","onOpen","addClass","setTimeout","offset","left","parent","css","closest","onChange","onClose","date","dateAlternate","removeClass","replace","includes","html","clear","on","length","value","column","toggleClass","toggle","indexOf","init","document","ready"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n/**\n * Course Completion report page.\n *\n * @package     local_edwiserreports\n * @author      Yogesh Shirsath\n * @copyright   2022 wisdmlabs <support@wisdmlabs.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine('local_edwiserreports/reports/completion', [\n    'jquery',\n    'core/notification',\n    'local_edwiserreports/common',\n    'local_edwiserreports/defaultconfig',\n    'local_edwiserreports/select2',\n    'local_edwiserreports/flatpickr'\n], function($, Notification, common, CFG) {\n\n    /**\n     * Selectors list.\n     */\n    var SELECTOR = {\n        PAGE: \".report-content\",\n        EXPORT: \".report-export\",\n        COHORT: \".report-content .cohort-select\",\n        COURSE: \".report-content .course-select\",\n        GROUP: \".report-content .group-select\",\n        EXCLUDE: '.report-content .exclude-select',\n        INACTIVE: '.report-content .inactive-select',\n        PROGRESS: '.report-content .progress-select',\n        GRADE: '.report-content .grade-select',\n        LENGTH: \".report-content .length-select\",\n        SEARCH: \".report-content .table-search-input input\",\n        PAGETITLE: \".report-header .page-title h2\",\n        FORMFILTER: '.report-content .download-links [name=\"filter\"]',\n        DATE: '.edwiserreports-calendar',\n        DATEMENU: '.edwiserreports-calendar + .dropdown-menu',\n        DATEITEM: '.edwiserreports-calendar + .dropdown-menu .dropdown-item',\n        DATEPICKER: '.edwiserreports-calendar + .dropdown-menu .dropdown-calendar',\n        DATEPICKERINPUT: '.edwiserreports-calendar + .dropdown-menu .flatpickr'\n    };\n\n    /**\n     * Filter object.\n     */\n    var filter = {\n        cohort: 0,\n        course: null,\n        group: 0,\n        exclude: [],\n        enrolment: 'all',\n        inactive: 'all',\n        progress: 'all',\n        grade: 'all',\n    };\n\n    /**\n     * Flat picker object.\n     */\n    let flatpickr = null;\n\n    /**\n     * Datatable object.\n     */\n    var dataTable = null;\n\n    /**\n     * Promise lists.\n     */\n    let PROMISES = {\n        /**\n         * Get all courses summary table data based on filters.\n         * @returns {PROMISE}\n         */\n        GET_DATA: function() {\n            return $.ajax({\n                url: CFG.requestUrl,\n                type: CFG.requestType,\n                dataType: CFG.requestDataType,\n                data: {\n                    action: 'get_completion_data_ajax',\n                    sesskey: M.local_edwiserreports.secret,\n                    lang: $('html').attr('lang'),\n                    data: JSON.stringify(filter)\n                },\n            });\n        }\n    };\n\n    /**\n     * After Select Custom date get active users details.\n     */\n    function customDateSelected() {\n        let date = $(SELECTOR.DATEPICKERINPUT).val(); // Y-m-d format\n        let dateAlternate = $(SELECTOR.DATEPICKERINPUT).next().val().replace(\"to\", \"-\"); // d M Y format\n        $(SELECTOR.DATEPICKERINPUT).next().val(dateAlternate);\n\n        /* If correct date is not selected then return false */\n        if (!date.includes(\" to \")) {\n            flatpickr.clear();\n            return;\n        }\n\n        // Set active class to custom date selector item.\n        $(SELECTOR.DATEITEM).removeClass('active');\n        $(SELECTOR.DATEITEM + '.custom').addClass('active');\n\n        // Show custom date to dropdown button.\n        $(SELECTOR.DATE).html(dateAlternate);\n\n        filter.enrolment = date;\n        initializeDatatable();\n        common.updateTimeLabel(date);\n    }\n\n    /**\n     * Get Course Completion\n     */\n    function initializeDatatable() {\n        common.loader.show(SELECTOR.PAGE);\n\n        $(SELECTOR.PAGE).find('.download-links input[name=\"filter\"]').val(JSON.stringify(filter));\n        let statuses = [\n            `<span class=\"warning-tag\">${M.util.get_string('notyetstarted', 'core_completion')}</span>`,\n            `<span class=\"success-tag\">${M.util.get_string('completed', 'core_completion')}</span>`,\n            `<span class=\"danger-tag\">${M.util.get_string('inprogress', 'core_completion')}</span>`\n        ];\n        let never = M.util.get_string('never', 'local_edwiserreports');\n        PROMISES.GET_DATA(filter).done(function(response) {\n            if (dataTable != null) {\n                dataTable.destroy();\n            }\n            $(SELECTOR.PAGETITLE).text(response.name);\n            dataTable = $(SELECTOR.PAGE).find(\".table\").DataTable({\n                dom: '<\"edwiserreports-table\"<\"table-filter d-flex\"i><t><\"table-pagination\"p>>',\n                data: response.data,\n                pageLength: $(SELECTOR.LENGTH).val(),\n                deferRendering: true,\n                language: {\n                    info: M.util.get_string('tableinfo', 'local_edwiserreports'),\n                    infoEmpty: M.util.get_string('infoempty', 'local_edwiserreports'),\n                    emptyTable: M.util.get_string('nostudentsenrolled', 'local_edwiserreports'),\n                    zeroRecords: M.util.get_string('zerorecords', 'local_edwiserreports'),\n                    paginate: {\n                        previous: \"◀\",\n                        next: \"▶\"\n                    }\n                },\n                columnDefs: [\n                    { className: \"fixed-column\", targets: 0 },\n                    { className: \"text-left\", targets: [0, 1, 2] },\n                    { className: \"text-right\", targets: \"_all\" }\n                ],\n                columns: [\n                    { data: \"learner\" },\n                    { data: \"email\" },\n                    {\n                        data: \"status\",\n                        render: function(data) {\n                            return statuses[data];\n                        },\n                        width: \"4rem\"\n                    },\n                    {\n                        data: \"enrolledon\",\n                        render: function(data) {\n                            return `<span class=\"d-none\">${data}</span>` +\n                                (data == 0 ? '-' : common.formatDate(new Date(data * 1000), \"d MMM yyyy\"));\n                        }\n                    },\n                    {\n                        data: \"completedon\",\n                        render: function(data) {\n                            return `<span class=\"d-none\">${data}</span>` +\n                                (data == 0 ? '-' : common.formatDate(new Date(data * 1000), \"d MMM yyyy\"));\n                        }\n                    },\n                    {\n                        data: \"lastaccess\",\n                        render: function(data) {\n                            return `<span class=\"d-none\">${data}</span>` +\n                                (data == 0 ? never : common.formatDate(new Date(data * 1000), \"d MMM yyyy hh:mm TT\"));\n                        },\n                        width: \"6rem\"\n                    },\n                    { data: \"progress\" },\n                    { data: \"grade\" },\n                    { data: \"completedactivities\", width: \"5rem\" },\n                    { data: \"assignment\", width: \"6rem\" },\n                    { data: \"quiz\", width: \"5rem\" },\n                    { data: \"scorm\", width: \"5rem\" },\n                    { data: \"visits\", width: \"2rem\" },\n                    {\n                        data: \"timespent\",\n                        render: function(data) {\n                            return common.timeFormatter(data);\n                        }\n                    }\n                ],\n                drawCallback: function() {\n                    common.stylePaginationButton(this);\n                },\n                initComplete: function() {\n                    common.loader.hide(SELECTOR.PAGE);\n                }\n            });\n            dataTable.columns(0).search($(SELECTOR.SEARCH).val());\n            dataTable.page.len($(SELECTOR.LENGTH).val()).draw();\n        }).fail(function(ex) {\n            Notification.exception(ex);\n            common.loader.hide(SELECTOR.PAGE);\n        });\n    }\n\n    /**\n     * Reload filters.\n     */\n    function reloadFilter(types, cohort, course, callback) {\n        common.loader.show(SELECTOR.PAGE);\n        common.reloadFilter(\n            SELECTOR.PAGE,\n            types,\n            cohort,\n            course,\n            0,\n            callback\n        );\n    }\n\n    /* eslint-disable no-unused-vars */\n    /**\n     * Initialize\n     * @param {integer} CONTEXTID Current page context id\n     */\n    function init(CONTEXTID) {\n\n        // Show time period in table info.\n        common.updateTimeLabel('all');\n\n        common.handleSearchInput();\n\n        // Initialize select2.\n        $(SELECTOR.PAGE).find('.singleselect').not(SELECTOR.EXCLUDE).select2();\n        $(SELECTOR.EXCLUDE).select2({\n            placeholder: M.util.get_string('exclude', 'local_edwiserreports'),\n            allowClear: true\n        });\n\n        flatpickr = $(SELECTOR.DATEPICKERINPUT).flatpickr({\n            mode: 'range',\n            altInput: true,\n            altFormat: \"d M Y\",\n            dateFormat: \"Y-m-d\",\n            maxDate: \"today\",\n            appendTo: $(SELECTOR.DATEPICKER).get(0),\n            onOpen: function() {\n                $(SELECTOR.DATEMENU).addClass('withcalendar');\n                setTimeout(function() {\n                    if ($(SELECTOR.DATEMENU).offset().left < $(SELECTOR.PAGE).parent().offset().left) {\n                        $(SELECTOR.DATEMENU).css('left', $(SELECTOR.DATEMENU).closest('.filter-selector').css('padding-left'));\n                    }\n                }, 500);\n            },\n            onChange: function() {\n                if ($(SELECTOR.DATEMENU).offset().left < $(SELECTOR.PAGE).parent().offset().left) {\n                    $(SELECTOR.DATEMENU).css('left', $(SELECTOR.DATEMENU).closest('.filter-selector').css('padding-left'));\n                }\n            },\n            onClose: function() {\n                $(SELECTOR.DATEMENU).removeClass('withcalendar');\n                customDateSelected();\n            }\n        });\n\n\n        /* Date selector listener */\n        $('body').on('click', SELECTOR.DATEITEM + \":not(.custom)\", function() {\n            // Set custom selected item as active.\n            $(SELECTOR.DATEITEM).removeClass('active');\n            $(this).addClass('active');\n\n            // Show selected item on dropdown button.\n            $(SELECTOR.DATE).html($(this).text());\n\n            // Clear custom date.\n            flatpickr.clear();\n\n            filter.enrolment = $(this).data('value');\n            initializeDatatable();\n            common.updateTimeLabel(filter.enrolment);\n        });\n\n        // Get course id\n        filter.course = $(SELECTOR.COURSE).val();\n\n        // Select cohort filter for completion table.\n        $('body').on('change', SELECTOR.COHORT, function() {\n            filter.cohort = $(this).val();\n            filter.group = 0;\n            reloadFilter(['course', 'noallcourses'], filter.cohort, filter.course, function() {\n                if ($(SELECTOR.COURSE).find(`option[value=\"${filter.course}\"]`).length == 0) {\n                    filter.course = $(SELECTOR.COURSE).find(`option:first`).attr('value');\n                }\n                reloadFilter(['group'], filter.cohort, filter.course, function() {\n                    initializeDatatable();\n                });\n            });\n        });\n\n        // Select course filter for completion table.\n        $('body').on('change', SELECTOR.COURSE, function() {\n            filter.course = $(this).val();\n            filter.group = 0;\n            reloadFilter(['group'], filter.cohort, filter.course, function() {\n                initializeDatatable();\n            });\n        });\n\n        // Select group filter for completion table.\n        $('body').on('change', SELECTOR.GROUP, function() {\n            filter.group = $(this).val();\n            initializeDatatable();\n        });\n\n        // Observer length change.\n        $('body').on('change', SELECTOR.LENGTH, function() {\n            dataTable.page.len(this.value).draw();\n        });\n\n        // Search in table.\n        $('body').on('input', SELECTOR.SEARCH, function() {\n            dataTable.column(0).search(this.value).draw();\n        });\n\n        // Observer exclude change.\n        $('body').on('change', SELECTOR.EXCLUDE, function() {\n            filter.exclude = $(this).val();\n            $(this).toggleClass('notselected', filter.exclude.length == 0);\n            $(this).toggleClass('selected', filter.exclude.length != 0);\n            // Display none to inactive users if exclude is selected.\n            $(SELECTOR.INACTIVE).closest('.filter-selector')\n                .toggle(filter.exclude.indexOf('2') == -1 && filter.exclude.indexOf('3') == -1);\n            initializeDatatable();\n        });\n\n        // Observer progress change.\n        $('body').on('change', SELECTOR.PROGRESS, function() {\n            filter.progress = $(this).val();\n            initializeDatatable();\n        });\n\n        // Observer inactive users change.\n        $('body').on('change', SELECTOR.INACTIVE, function() {\n            filter.inactive = $(this).val();\n            initializeDatatable();\n        });\n\n        // Observer grade change.\n        $('body').on('change', SELECTOR.GRADE, function() {\n            filter.grade = $(this).val();\n            initializeDatatable();\n        });\n\n        initializeDatatable();\n    }\n\n    return {\n        init: function(CONTEXTID) {\n            $(document).ready(function() {\n                init(CONTEXTID);\n            });\n        }\n    };\n\n});"],"file":"completion.min.js"}
"use strict";define(["jquery","core/notification","./chart/apexcharts","./defaultconfig","./common","./select2"],function(e,t,r,o,n){let s="rtl"==e("html").attr("dir")?1:0;return{init:function(a){var i=null,l=o.getPanel("#courseprogressblock"),c=o.getPanel("#courseprogressblock","body"),d=c+" .course-select",g=c+" .loader",u=s?"left":"right",p={data:[0,0,0,0,0,0],labels:["81% - 100%","61% - 80%","41% - 60%","21% - 40%","0% - 20%"]},f=e(l+" form.download-links");function h(){var s=e(d).val();f.find('input[name="filter"]').val(s),i&&i.destroy(),n.loader.show("#courseprogressblock"),e.ajax({url:o.requestUrl,type:o.requestType,dataType:o.requestDataType,data:{action:"get_courseprogress_graph_data_ajax",secret:M.local_edwiserreports.secret,lang:e("html").attr("lang"),data:JSON.stringify({courseid:s})}}).done(function(e){!0!==e.error||"invalidsecretkey"!==e.exception.errorcode?(p.data=e.data,p.average=0==e.average?0:e.average.toPrecision(2),p.tooltipStrings=e.tooltip,n.insight("#courseprogressblock .insight",e.insight)):a("courseprogressblock",e)}).fail(function(e){t.exception(e),p.average="0"}).always(function(){var t,s;t={series:p.data.reverse(),chart:{type:"donut",height:350},colors:o.getColorTheme(),fill:{type:"solid"},labels:p.labels,dataLabels:{enabled:!1},tooltip:{custom:function(e){let{series:t,seriesIndex:r,dataPointIndex:o,w:n}=e,s=t[r],a=s<2?p.tooltipStrings.single:p.tooltipStrings.plural,i=n.config.labels[r],l=n.config.colors[r];return`<div class="custom-donut-tooltip" style="text-align:center">\n                                    <div style="color: ${l};">\n                                        <span style="font-weight: 500;"> ${i}:</span>\n                                        <span style="font-weight: 700;"> ${s} ${a} </span>\n                                    </div>\n                                    <span style="color: black; font-size: 0.871rem;">\n                                        ${M.util.get_string("clickonchartformoreinfo","local_edwiserreports")}\n                                    </span>\n                                </div>`}},legend:{position:u,formatter:function(e,t){return[e+": "+t.w.globals.series[t.seriesIndex]]}}},(s=new r(e("#apex-chart-course-progress").get(0),t)).render(),i=s,e(g).hide(),n.loader.hide("#courseprogressblock")})}0!=e(d).length&&(h(),e(c+" .singleselect").select2(),e(d).on("change",function(){e(g).show(),h()}),setInterval(function(){if(null===i)return;let t=e(l).find(".apexcharts-canvas").width()>=400?s?"left":"right":"bottom";t!=u&&(u=t,i.updateOptions({legend:{position:u}}))},1e3),n.handleFilterSize(c))}}});
//# sourceMappingURL=block_courseprogress.min.js.map

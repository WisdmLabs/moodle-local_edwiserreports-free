"use strict";define(["jquery","local_edwiserreports/chart/apexcharts","local_edwiserreports/defaultconfig","local_edwiserreports/variables","./common","local_edwiserreports/select2"],function(e,r,o,t,s){return{init:function(a){var l=null,i=o.getPanel("#courseprogressblock"),c=o.getPanel("#courseprogressblock","body"),n=c+" #wdm-courseprogress-select",p=c+" .ct-chart",d=c+" .loader",g={type:"pie",data:[0,0,0,0,0,0],options:{responsive:!0,legend:{position:"bottom"},maintainAspectRatio:!1,aspectRatio:1,tooltips:{callbacks:{title:function(e,r){return[M.util.get_string("cpblocktooltip1",t.component,{per:r.labels[e[0].index]}),M.util.get_string("cpblocktooltip2",t.component,{val:r.datasets[0].data[e[0].index]})]},label:function(){return""}}}},labels:["0% - 20%","21% - 40%","41% - 60%","61% - 80%","81% - 100%"],backgroundColor:["#fe6384","#36a2eb","#fdce56","#c70fbe","#4ac0c0","#ff851b"]},u=e(i+" form.download-links");function f(){var t=e(n).val();u.find('input[name="filter"]').val(t),l&&l.destroy(),s.loader.show("#courseprogressblock"),e.ajax({url:o.requestUrl,type:o.requestType,dataType:o.requestDataType,data:{action:"get_courseprogress_graph_data_ajax",secret:M.local_edwiserreports.secret,data:JSON.stringify({courseid:t})}}).done(function(e){!0!==e.error||"invalidsecretkey"!==e.exception.errorcode?(g.data=e.data,g.average=0==e.average?0:e.average.toPrecision(2),g.pro=e.pro):a("courseprogressblock",e)}).fail(function(e){g.average="0"}).always(function(){s.insight("#courseprogressblock .insight",{insight:{value:"??",title:M.util.get_string("averagecourseprogress","local_edwiserreports")},pro:g.pro}),l=function(){var t={series:g.data,chart:{type:"pie",height:350},colors:o.getColorPalette(),fill:{type:"solid"},labels:g.labels,legend:{position:"bottom",offsetY:0}},s=new r(e("#apex-chart-course-progress").get(0),t);return s.render(),s}(),e(d).hide(),e(p).fadeIn("slow"),s.loader.hide("#courseprogressblock")})}0!=e(n).length&&(f(),e(c+" .singleselect").select2(),e(n).on("change",function(){e(p).hide(),e(d).show(),f()}))}}});
//# sourceMappingURL=block_courseprogress.min.js.map

"use strict";define(["jquery","core/notification","./chart/apexcharts","./defaultconfig","./common","./select2"],function(e,t,o,r,s){return{init:function(a){var n=null,i=r.getPanel("#courseprogressblock"),l=r.getPanel("#courseprogressblock","body"),c=l+" #wdm-courseprogress-select",d=l+" .loader",g="right",u={data:[0,0,0,0,0,0],labels:["81% - 100%","61% - 80%","41% - 60%","21% - 40%","0% - 20%"]},p=e(i+" form.download-links");function f(){var i=e(c).val();p.find('input[name="filter"]').val(i),n&&n.destroy(),s.loader.show("#courseprogressblock"),e.ajax({url:r.requestUrl,type:r.requestType,dataType:r.requestDataType,data:{action:"get_courseprogress_graph_data_ajax",secret:M.local_edwiserreports.secret,lang:e("html").attr("lang"),data:JSON.stringify({courseid:i})}}).done(function(e){!0!==e.error||"invalidsecretkey"!==e.exception.errorcode?(u.data=e.data,u.average=0==e.average?0:e.average.toPrecision(2),u.tooltipStrings=e.tooltip,s.insight("#courseprogressblock .insight",e.insight)):a("courseprogressblock",e)}).fail(function(e){t.exception(e),u.average="0"}).always(function(){var t,a;t={series:u.data.reverse(),chart:{type:"donut",height:350},colors:r.getColorTheme(),fill:{type:"solid"},labels:u.labels,dataLabels:{enabled:!1},tooltip:{custom:function(e){var t=e.series,o=e.seriesIndex,r=(e.dataPointIndex,e.w),s=t[o],a=s<2?u.tooltipStrings.single:u.tooltipStrings.plural,n=r.config.labels[o],i=r.config.colors[o];return'<div class="custom-donut-tooltip" style="color: '.concat(i,';">\n                                <span style="font-weight: 500;"> ').concat(n,':</span>\n                                <span style="font-weight: 700;"> ').concat(s," ").concat(a,"</span>\n                            </div>")}},legend:{position:g,formatter:function(e,t){return[e+": "+t.w.globals.series[t.seriesIndex]]}}},(a=new o(e("#apex-chart-course-progress").get(0),t)).render(),n=a,e(d).hide(),s.loader.hide("#courseprogressblock")})}0!=e(c).length&&(f(),e(l+" .singleselect").select2(),e(c).on("change",function(){e(d).show(),f()}),setInterval(function(){if(null!==n){var t=e(i).find(".apexcharts-canvas").width()>=400?"right":"bottom";t!=g&&(g=t,n.updateOptions({legend:{position:g}}))}},1e3))}}});
//# sourceMappingURL=block_courseprogress.min.js.map

"use strict";define(["jquery","core/templates","./common","./defaultconfig"],function(t,i,e,n){var s={CONTAINER:".top-insights",INSIGHT:".top-insights .insight",ONLYINSIGHT:".top-insights .insight:not(.add-insight)",INSIGHT_CONTENT:".insight-content",MOVELEFT:".top-insights .card-editing .move-left",MOVERIGHT:".top-insights .card-editing .move-right",HIDE:".top-insights .card-editing .edit-hide",INSIGHT_ADD_CARD:".top-insights .insight.add-insight",INSIGHT_DROPDOWNMENU:".top-insights .add-new-insight .dropdown-menu",INSIGHT_ITEM:".top-insights .add-new-insight .dropdown-item"},o={GET_INSIGHT_CARD_CONTEXT:function(i){return t.ajax({url:n.requestUrl,type:n.requestType,dataType:n.requestDataType,data:{action:"get_insight_card_context_ajax",secret:M.local_edwiserreports.secret,data:JSON.stringify({id:i})}})}};function r(){var i=[];e.loader.show(s.CONTAINER),t(s.ONLYINSIGHT).each(function(e,n){i.push(t(n).data("id"))}),M.util.set_user_preference("local_edwiserreports_insights_order",JSON.stringify(i)),e.loader.hide(s.CONTAINER)}return{init:function(){t(document).ready(function(){t("body").on("click",s.MOVELEFT,function(){var i=t(this).closest(s.INSIGHT).prev();t(this).closest(s.INSIGHT).detach().insertBefore(i),r()}),t("body").on("click",s.MOVERIGHT,function(){var i=t(this).closest(s.INSIGHT).next();t(this).closest(s.INSIGHT).detach().insertAfter(i),r()}),t("body").on("click",s.HIDE,function(){var i=t(this).closest(s.INSIGHT);t(s.INSIGHT_DROPDOWNMENU).prepend('<a class="dropdown-item" href="#" data-id="'.concat(i.data("id"),'">').concat(i.find(".insight-title").text(),"</a>")),i.remove(),r()}),t("body").on("click",s.INSIGHT_ITEM,function(){var n=t(this).data("id");e.loader.hide(s.CONTAINER),o.GET_INSIGHT_CARD_CONTEXT(n).then(function(e){1==e.present&&(e.editing=!0,i.render("local_edwiserreports/insights/insight",e).done(function(e,o){t(s.INSIGHT_ADD_CARD).before(e),i.runTemplateJS(o),t(s.INSIGHT_ITEM+'[data-id="'+n+'"]').remove(),r()}))})})})}}});
//# sourceMappingURL=insights.min.js.map

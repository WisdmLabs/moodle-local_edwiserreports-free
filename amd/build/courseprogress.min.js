"use strict";define(["jquery","core/modal_factory","core/modal_events","core/fragment","./variables","./common","./jquery.dataTables","./dataTables.bootstrap4","./select2"],function(e,t,o,a,r,s){return{init:function(i){var l="#wdm-courseprogress-individual",n=l+" .table",d=l+" .loader",c=n+" a.modal-trigger",u=null,p=null,g=0,m=e(l).data("sesskey"),h=r.requestUrl+"?action=get_courseprogress_graph_data_ajax&sesskey="+m;function f(t){s.loader.show("#page-local-edwiserreports-coursereport #wdm-courseprogress-individual"),e(n).show(),e(d).hide();var o=JSON.stringify({courseid:"all",cohortid:t});(u=e(n).DataTable({ajax:h+"&cohortid="+t+"&data="+o,dom:'<"edwiserreports-table"<"p-2"i><t><"table-pagination"p>>',columns:[{data:"coursename"},{data:"enrolments"},{data:"completed"},{data:"completed81to100"},{data:"completed61to80"},{data:"completed41to60"},{data:"completed21to40"},{data:"completed0to20"}],columnDefs:[{className:"text-left",targets:0},{className:"text-center modal-trigger",targets:"_all"}],language:{info:M.util.get_string("tableinfo","local_edwiserreports"),infoEmpty:M.util.get_string("infoempty","local_edwiserreports"),emptyTable:M.util.get_string("nocourses","local_edwiserreports"),zeroRecords:M.util.get_string("zerorecords","local_edwiserreports"),paginate:{previous:M.util.get_string("previous","moodle"),next:M.util.get_string("next","moodle")}},drawCallback:function(){e(n).find("th").addClass("theme-3-bg text-white"),s.stylePaginationButton(this)},initComplete:function(){s.loader.hide("#page-local-edwiserreports-coursereport #wdm-courseprogress-individual")}})).page.len(e("#wdm-courseprogress-individual .table-length-input select").val()).draw(),u.column(0).search(e("#wdm-courseprogress-individual .table-search-input input").val()).draw()}e("#page-local-edwiserreports-coursereport").find(".singleselect").select2(),e(document).ready(function(){s.handleSearchInput(),e("body").on("change","#wdm-courseprogress-individual .table-length-input select",function(){u.page.len(this.value).draw()}),e("body").on("input","#wdm-courseprogress-individual .table-search-input input",function(){u.column(0).search(this.value).draw()}),e("body").on("input",".courseprogress-modal .table-search-input input",function(){p.search(this.value).draw()}),f(g),e(document).on("change","#page-local-edwiserreports-coursereport .cohort-select",function(){u&&(u.destroy(),e(n).hide(),e(d).show()),g=e(this).val(),e("#page-local-edwiserreports-coursereport").find('.download-links input[name="cohortid"]').val(g),f(g)}),e(document).on("click",c,function(){var r=e(this).data("minvalue"),l=e(this).data("maxvalue"),n=e(this).data("courseid"),d=e(this).data("coursename"),c=null;t.create({body:a.loadFragment("local_edwiserreports","userslist",i,{page:"courseprogress",courseid:n,minval:r,maxval:l,cohortid:g})}).then(function(e){c=e.getRoot(),e.getBody().addClass("courseprogress-modal"),c.find(".modal-dialog").addClass("modal-lg"),e.setTitle(d),e.show(),c.on(o.hidden,function(){e.destroy()}),c.on(o.bodyRendered,function(){var e=c.find(".modal-table");e.find("tbody").hasClass("empty")&&e.find("tbody").empty(),p=e.DataTable({language:{info:M.util.get_string("tableinfo","local_edwiserreports"),infoEmpty:M.util.get_string("infoempty","local_edwiserreports"),emptyTable:M.util.get_string("nousers","local_edwiserreports"),zeroRecords:M.util.get_string("zerorecords","local_edwiserreports"),paginate:{previous:M.util.get_string("previous","moodle"),next:M.util.get_string("next","moodle")}},dom:'<"edwiserreports-table"i<t><"table-pagination"p>>',drawCallback:function(){e.find("th").addClass("theme-3-bg text-white"),s.stylePaginationButton(this)},lengthChange:!1})})})})})}}});
//# sourceMappingURL=courseprogress.min.js.map

"use strict";define(["jquery","core/modal_factory","core/modal_events","core/fragment","./variables","./common","./jquery.dataTables","./dataTables.bootstrap4","./select2"],function(e,t,a,o,r,s){var l={PANEL:"#wdm-courseprogress-individual",COHORT:".cohort-select",COURSE:".course-select",GROUP:".group-select",STUDENT:".student-select",GRAPH:".graph",GRAPHLABEL:".graph-label",FORMFILTER:'.download-links [name="filter"]',FILTERS:".filters"};let i="rtl"==e("html").attr("dir")?1:0;return{init:function(n){var d="#wdm-courseprogress-individual",c=d+" .table",u=d+" .loader",p=c+" a.modal-trigger",g=null,m=null;e(l.PANEL).find(l.FORMFILTER).val(i);var h=0,f=e(d).data("sesskey"),w=r.requestUrl+"?action=get_courseprogress_graph_data_ajax&sesskey="+f;function b(t){s.loader.show("#page-local-edwiserreports-coursereport #wdm-courseprogress-individual"),e(c).show(),e(u).hide();var a=JSON.stringify({courseid:"all",cohortid:t,rtl:i});(g=e(c).DataTable({ajax:w+"&cohortid="+t+"&data="+a,dom:'<"edwiserreports-table"<"p-2"i><t><"table-pagination"p>>',columns:[{data:"coursename"},{data:"enrolments"},{data:"completed"},{data:"completed81to100"},{data:"completed61to80"},{data:"completed41to60"},{data:"completed21to40"},{data:"completed0to20"}],columnDefs:[{className:"text-left",targets:0},{className:"text-right modal-trigger",targets:"_all"}],language:{info:M.util.get_string("tableinfo","local_edwiserreports"),infoEmpty:M.util.get_string("infoempty","local_edwiserreports"),emptyTable:M.util.get_string("nocourses","local_edwiserreports"),zeroRecords:M.util.get_string("zerorecords","local_edwiserreports"),paginate:{previous:" ",next:" "}},drawCallback:function(){e(c).find("th").addClass("theme-3-bg text-white"),s.stylePaginationButton(this)},initComplete:function(){s.loader.hide("#page-local-edwiserreports-coursereport #wdm-courseprogress-individual")}})).page.len(e("#wdm-courseprogress-individual .table-length-input select").val()).draw(),g.column(0).search(e("#wdm-courseprogress-individual .table-search-input input").val()).draw()}e("#page-local-edwiserreports-coursereport").find(".singleselect").select2(),e(document).ready(function(){s.handleSearchInput(),e("body").on("change","#wdm-courseprogress-individual .table-length-input select",function(){g.page.len(this.value).draw()}),e("body").on("input","#wdm-courseprogress-individual .table-search-input input",function(){g.column(0).search(this.value).draw()}),e("body").on("input",".courseprogress-modal .table-search-input input",function(){m.search(this.value).draw()}),b(h),e(document).on("change","#page-local-edwiserreports-coursereport .cohort-select",function(){g&&(g.destroy(),e(c).hide(),e(u).show()),h=e(this).val(),e("#page-local-edwiserreports-coursereport").find('.download-links input[name="cohortid"]').val(h),b(h)}),e(document).on("click",p,function(){var r=e(this).data("minvalue"),l=e(this).data("maxvalue"),i=e(this).data("courseid"),d=e(this).data("coursename"),c=null;t.create({body:o.loadFragment("local_edwiserreports","userslist",n,{page:"courseprogress",courseid:i,minval:r,maxval:l,cohortid:h})}).then(function(e){c=e.getRoot(),e.getBody().addClass("courseprogress-modal"),c.find(".modal-dialog").addClass("modal-lg"),e.setTitle(d),e.show(),c.on(a.hidden,function(){e.destroy()}),c.on(a.bodyRendered,function(){var e=c.find(".modal-table");e.find("tbody").hasClass("empty")&&e.find("tbody").empty(),m=e.DataTable({language:{info:M.util.get_string("tableinfo","local_edwiserreports"),infoEmpty:M.util.get_string("infoempty","local_edwiserreports"),emptyTable:M.util.get_string("nousers","local_edwiserreports"),zeroRecords:M.util.get_string("zerorecords","local_edwiserreports"),paginate:{previous:" ",next:" "}},dom:'<"edwiserreports-table"i<t><"table-pagination"p>>',drawCallback:function(){e.find("th").addClass("theme-3-bg text-white"),s.stylePaginationButton(this)},lengthChange:!1})})})})})}}});
//# sourceMappingURL=courseprogress.min.js.map

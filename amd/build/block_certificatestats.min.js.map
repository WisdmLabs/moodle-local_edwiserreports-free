{"version":3,"sources":["block_certificatestats.js"],"names":["define","$","templates","cfg","common","panel","getPanel","panelBody","table","dropdownBody","init","hideLoader","loader","hide","length","show","ajax","url","requestUrl","type","requestType","dataType","requestDataType","data","action","secret","M","local_edwiserreports","done","response","error","exception","errorcode","invalidUser","render","then","html","js","empty","appendNodeContents","DataTable","oLanguage","sEmptyTable","sSearchPlaceholder","initComplete","drawCallback","addClass","lengthChange","bInfo","fail","ex","console","log"],"mappings":"AAAA,aA0BAA,OAAO,CAAC,SAAU,iBAAkB,qCAAsC,YAAa,SAAUC,EAAGC,EAAWC,EAAKC,GAClH,IAAIC,EAAQF,EAAIG,SAAS,sBACrBC,EAAYJ,EAAIG,SAAS,qBAAsB,QAC/CE,EAAQH,EAAQ,UAChBI,EAAeJ,EAAQ,mBAwE3B,MAAO,CACLK,KApEF,WAIE,SAASC,IACPP,EAAOQ,OAAOC,KAAK,sBAGjBZ,EAAEI,GAAOS,SAEXV,EAAOQ,OAAOG,KAAK,sBACnBd,EAAEe,KAAK,CACLC,IAAKd,EAAIe,WACTC,KAAMhB,EAAIiB,YACVC,SAAUlB,EAAImB,gBACdC,KAAM,CACJC,OAAQ,6BACRC,OAAQC,EAAEC,qBAAqBF,UAEhCG,KAAK,SAAUC,IACO,IAAnBA,EAASC,OAAmD,qBAAjCD,EAASE,UAAUC,WAChDC,YAAY,wBAAyBJ,GAGvC3B,EAAUgC,OAAO,yCAA0CL,EAASN,MAAMY,KAAK,SAAUC,EAAMC,GAC7FpC,EAAEM,GAAW+B,QACbpC,EAAUqC,mBAAmBhC,EAAW6B,EAAMC,GACtBR,EAASN,KAsBvCtB,EAAEO,GAAOgC,UAAU,CACjBC,UAAW,CACTC,YAAa,kCACbC,mBAAoB,uBAEtBC,aAAc,WACZ3C,EAAEQ,GAAcM,QAElB8B,aAAc,WACZ5C,EAAE,sCAAsC6C,SAAS,4BACjD7C,EAAE,sBAAsB6C,SAAS,6BAEnCC,cAAc,EACdC,OAAO,IAjCHrC,MAECsC,KAAK,SAAUC,GAChBC,QAAQC,IAAIF,GAEZvC,QAEDsC,KAAK,SAAUnB,GAGhBnB","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n/**\n * Plugin administration pages are defined here.\n *\n * @package     local_edwiserreports\n * @copyright   2021 wisdmlabs <support@wisdmlabs.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n/* eslint-disable no-console */\ndefine([\n    \"jquery\",\n    \"core/templates\",\n    \"local_edwiserreports/defaultconfig\",\n    './common',\n], function($, templates, cfg, common) {\n    var panel = cfg.getPanel(\"#certificatesblock\");\n    var panelBody = cfg.getPanel(\"#certificatesblock\", \"body\");\n    var table = panel + \" .table\";\n    var dropdownBody = panel + \" .table-dropdown\";\n\n    /**\n     * Initialize\n     */\n    function init() {\n        /**\n         * Hide loader/\n         */\n        function hideLoader() {\n            common.loader.hide('#certificatesblock');\n        }\n\n        if ($(panel).length) {\n            // Show loader.\n            common.loader.show('#certificatesblock');\n\n            $.ajax({\n                url: cfg.requestUrl,\n                type: cfg.requestType,\n                dataType: cfg.requestDataType,\n                data: {\n                    action: 'get_certificates_data_ajax',\n                    secret: M.local_edwiserreports.secret\n                },\n            }).done(function(response) {\n                if (response.error === true && response.exception.errorcode === 'invalidsecretkey') {\n                    invalidUser('certificatestatsblock', response);\n                }\n                templates.render('local_edwiserreports/certificatestable', response.data)\n                    .then(function(html, js) {\n                        $(panelBody).empty();\n                        templates.appendNodeContents(panelBody, html, js);\n                        createCertificatesTable(response.data);\n\n                        // Hide loader.\n                        hideLoader();\n                        return;\n                    }).fail(function(ex) {\n                        console.log(ex);\n\n                        // Hide loader.\n                        hideLoader();\n                    });\n            })\n            .fail(function(error) {\n                // console.log(error);\n\n                // Hide loader.\n                hideLoader();\n            });\n        }\n    }\n\n    /**\n     * Create certificate table.\n     */\n    function createCertificatesTable() {\n        $(table).DataTable({\n            oLanguage: {\n                sEmptyTable: \"There is no certificate created\",\n                sSearchPlaceholder: \"Search Certificates\"\n            },\n            initComplete: function() {\n                $(dropdownBody).show();\n            },\n            drawCallback: function() {\n                $('.dataTables_paginate > .pagination').addClass('pagination-sm pull-right');\n                $('.dataTables_filter').addClass('pagination-sm pull-right');\n            },\n            lengthChange: false,\n            bInfo: false\n        });\n    }\n\n    // Must return the init function\n    return {\n        init: init\n    };\n});\n"],"file":"block_certificatestats.min.js"}
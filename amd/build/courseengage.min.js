"use strict";
define(["jquery", "core/modal_factory", "core/modal_events", "core/fragment", "./variables", "./common", "./jquery.dataTables", "./dataTables.bootstrap4"], function(e, a, t, o, r, n) {
    return {
        init: function(s) {
            var d = "#wdm-courseengage-individual",
                l = d + " .table",
                i = d + " .loader",
                c = e(d).data("sesskey"),
                u = r.requestUrl + "?action=get_courseengage_data_ajax&sesskey=" + c,
                g = l + " a.modal-trigger",
                h = null,
                m = 0;

            function f(a) { n.loader.show("#page-local-edwiserreports-coursereport #wdm-courseengage-individual"), e(l).show(), e(i).hide(), h = e(l).DataTable({ ajax: u + "&cohortid=" + a, dom: '<"edwiserreports-table"<"table-filter d-flex"fl><"p-2"i><t><"table-pagination"p>>', columns: [{ data: "coursename" }, { data: "enrolment" }, { data: "visited" }, { data: "activitystart" }, { data: "completedhalf" }, { data: "coursecompleted" }], columnDefs: [{ className: "text-left", targets: 0 }, { className: "text-center modal-trigger", targets: "_all" }], language: { searchPlaceholder: "Search Course", emptyTable: "There are no courses" }, drawCallback: function() { e(l).find("th").addClass("theme-3-bg text-white"), n.stylePaginationButton(this) }, initComplete: function() { n.loader.hide("#page-local-edwiserreports-coursereport #wdm-courseengage-individual") } }) }
            e(document).ready(function() {
                f(m), e(document).on("change", "#page-local-edwiserreports-coursereport .cohort-select", function() { h && (h.destroy(), e(l).hide(), e(i).show()), f(m = e(this).val()) }), e(document).on("click", g, function() {
                    var r = e(this).data("action"),
                        d = e(this).data("courseid"),
                        l = e(this).data("coursename"),
                        i = null;
                    a.create({ body: o.loadFragment("local_edwiserreports", "userslist", s, { page: "courseengage", courseid: d, action: r, cohortid: m }) }).then(function(a) {
                        (i = a.getRoot()).find(".modal-dialog").addClass("modal-lg"), a.setTitle(l), a.show(), i.on(t.hidden, function() { a.destroy() }), i.on(t.shown, function() { e(window).resize() }), i.on(t.bodyRendered, function() {
                            var e = i.find(".modal-table");
                            e.find("tbody").hasClass("empty") && e.find("tbody").empty(), e.DataTable({ language: { searchPlaceholder: "Search User", emptyTable: "There are no users" }, dom: '<"edwiserreports-table"<"table-filter d-flex"f><t><"table-pagination"p>>', drawCallback: function() { e.find("th").addClass("theme-3-bg text-white"), n.stylePaginationButton(this) }, lengthChange: !1, bInfo: !1 })
                        })
                    })
                })
            })
        }
    }
});
//# sourceMappingURL=courseengage.min.js.map
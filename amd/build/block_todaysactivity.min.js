/**
 * Plugin administration pages are defined here.
 *
 * @copyright   2021 wisdmlabs <support@wisdmlabs.com>
 * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */ define(["jquery","core/notification","./chart/apexcharts","./defaultconfig","./common"],function(t,a,o,e,i){var r="rtl"==t("html").attr("dir")?1:0;return{init:function c(d){var l,s=e.getPanel("#todaysactivityblock"),n=e.getPanel("#todaysactivityblock","body"),y=s+" #flatpickrCalender-todaysactivity";function h(r){i.loader.show("#todaysactivityblock"),t.ajax({url:e.requestUrl,type:e.requestType,dataType:e.requestDataType,data:{action:"get_todaysactivity_data_ajax",secret:M.local_edwiserreports.secret,lang:t("html").attr("lang"),data:JSON.stringify({date:r})}}).done(function(a){var i,r;if(!0===a.error&&"invalidsecretkey"===a.exception.errorcode){d("todaysactivityblock",a);return}t.each(a.data,function(a,o){t(n+" #todays-"+a).find(".data").html(o)}),i=a.data.visitshour,e.todaysActivityBlock.graph.data=i,i={labels:e.todaysActivityBlock.graph.labels,datasets:[{label:e.todaysActivityBlock.graph.labelName,data:e.todaysActivityBlock.graph.data,backgroundColor:e.todaysActivityBlock.graph.backgroundColor}]},r={series:[{data:e.todaysActivityBlock.graph.data}],chart:{type:"bar",height:150,toolbar:{show:!1}},plotOptions:{bar:{borderRadius:4,horizontal:!1,colors:{ranges:[{from:0,to:100}]}}},grid:{show:!1},dataLabels:{enabled:!1},yaxis:{show:!1},tooltip:{theme:"dark",custom:function({series:t,seriesIndex:a,dataPointIndex:o,w:e}){return'<div class="text-center p-1">'+e.config.xaxis.categories[o]+"<br>"+t[a][o]+"</div>"}},xaxis:{categories:e.todaysActivityBlock.graph.labels},colors:[e.getColorTheme()[2]]},l&&l.destroy(),(l=new o(t("#apex-chart-todays-activity").get(0),r)).render()}).fail(function(t){a.exception(t)}).always(function(){i.loader.hide("#todaysactivityblock")})}t(document).ready(function(){e.todaysActivityBlock=e.getTodaysActivityBlock(),e.todaysActivityBlock&&(h(),t(y).flatpickr({dateFormat:r?"Y M d":"d M Y",maxDate:"today",defaultDate:["today"],onChange:function(t,a,o){h(a)}}))})}}});

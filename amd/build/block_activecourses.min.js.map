{"version":3,"sources":["block_activecourses.js"],"names":["define","$","Chart","cfg","common","init","notifyListner","activeCourseTable","panel","getPanel","panelBody","loader","table","length","show","ajax","url","requestUrl","type","requestType","dataType","requestDataType","data","action","sesskey","done","response","destroy","DataTable","responsive","aaSorting","aoColumns","orderSequence","language","searchPlaceholder","initComplete","hide","fadeIn","drawCallback","addClass","columnDefs","targets","className","orderable","lengthChange","bInfo","fail","error","console","log","always","on","column","search","order","nodes","each","cell","i","innerHTML","draw"],"mappings":"AAAA,aA0BAA,OAAO,CAAC,SAAU,eAAgB,qCAAsC,WAAY,yCAA0C,8CAA+C,SAAUC,EAAGC,EAAOC,EAAKC,GAkHpM,MAAO,CACLC,KA9GF,SAAcC,GACZ,IAAIC,EACAC,EAAQL,EAAIM,SAAS,uBACrBC,EAAYP,EAAIM,SAAS,sBAAuB,QAChDE,EAASD,EAAY,WACrBE,EAAQF,EAAY,UAEpBT,EAAEO,GAAOK,QAEXT,EAAOO,OAAOG,KAAK,uBAGnBb,EAAEc,KAAK,CACLC,IAAKb,EAAIc,WACTC,KAAMf,EAAIgB,YACVC,SAAUjB,EAAIkB,gBACdC,KAAM,CACJC,OAAQ,8BACRC,QAASvB,EAAEO,GAAOc,KAAK,cAExBG,KAAK,SAAUC,GAuCpB,IAAiCJ,EAAAA,EArCLI,EAASJ,KAuC/Bf,GACFA,EAAkBoB,UAKpBpB,EAAoBN,EAAEW,GAAOgB,UAAU,CACrCC,YAAY,EACZP,KAAMA,EACNQ,UAAW,CAAC,CAAC,EAAG,SAChBC,UAAW,CAAC,KAAM,KAAM,CACtBC,cAAiB,CAAC,SACjB,CACDA,cAAiB,CAAC,SACjB,CACDA,cAAiB,CAAC,UAEpBC,SAAU,CACRC,kBAAmB,iBAErBC,aAAc,WAEZlC,EAAEU,GAAQyB,OACVnC,EAAEW,GAAOyB,OAAO,SAElBC,aAAc,WACZrC,EAAE,sCAAsCsC,SAAS,4BACjDtC,EAAE,sBAAsBsC,SAAS,6BAEnCC,WAAY,CAAC,CACXC,QAAW,EACXC,UAAa,cACbC,WAAa,GACZ,CACDF,QAAW,EACXC,UAAa,YACbC,WAAa,GACZ,CACDF,QAAW,OACXC,UAAa,gBAEfE,cAAc,EACdC,OAAO,MAhFNC,KAAK,SAAUC,GAChBC,QAAQC,IAAIF,KACXG,OAAO,WAER3C,EAAkB4C,GAAG,qBAAsB,WACzC5C,EAAkB6C,OAAO,EAAG,CAC1BC,OAAQ,UACRC,MAAO,YACNC,QAAQC,KAAK,SAAUC,EAAMC,GAE5BD,EAAKE,UADE,GAALD,EACe,yCACH,GAALA,EACQ,2CACH,GAALA,EACQ,2CAEAA,EAAI,IAGzBzD,EAAEW,EAAQ,0BAA0B2B,SAAS,cAC5CqB,OAGHtD,EAAc,iBAEdF,EAAOO,OAAOyB,KAAK,0BAGrB9B,EAAc","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n/**\n * Plugin administration pages are defined here.\n *\n * @package     local_edwiserreports\n * @copyright   2021 wisdmlabs <support@wisdmlabs.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n *//* eslint-disable no-console */\ndefine([\n    'jquery',\n    'core/chartjs',\n    'local_edwiserreports/defaultconfig',\n    './common',\n    'local_edwiserreports/jquery.dataTables',\n    'local_edwiserreports/dataTables.bootstrap4'\n], function($, Chart, cfg, common) {\n    /**\n     * Initialize\n     * @param {function} notifyListner Callback function\n     */\n    function init(notifyListner) {\n        var activeCourseTable;\n\n        var panel = cfg.getPanel(\"#activecoursesblock\");\n        var panelBody = cfg.getPanel(\"#activecoursesblock\", \"body\");\n        var loader = panelBody + \" .loader\";\n        var table = panelBody + \" .table\";\n\n        if ($(panel).length) {\n            // Show loader.\n            common.loader.show('#activecoursesblock');\n\n            /* Ajax request to get data for active courses table */\n            $.ajax({\n                url: cfg.requestUrl,\n                type: cfg.requestType,\n                dataType: cfg.requestDataType,\n                data: {\n                    action: 'get_activecourses_data_ajax',\n                    sesskey: $(panel).data(\"sesskey\")\n                },\n            }).done(function(response) {\n                /* Create active course table */\n                createActiveCourseTable(response.data);\n            })\n            .fail(function(error) {\n                console.log(error);\n            })\n            .always(function() {\n                /* Added fixed column rank in datatable */\n                activeCourseTable.on('order.dt search.dt', function() {\n                    activeCourseTable.column(0, {search: 'applied', order: 'applied'}).nodes().each(function(cell, i) {\n                        if (i == 0) {\n                            cell.innerHTML = \"<i class='fa fa-trophy text-gold'></i>\";\n                        } else if (i == 1) {\n                            cell.innerHTML = \"<i class='fa fa-trophy text-silver'></i>\";\n                        } else if (i == 2) {\n                            cell.innerHTML = \"<i class='fa fa-trophy text-bronze'></i>\";\n                        } else {\n                            cell.innerHTML = i + 1;\n                        }\n                    });\n                    $(table + \" td:not(.bg-secondary)\").addClass(\"bg-white\");\n                }).draw();\n\n                /* Notify that this event is completed */\n                notifyListner(\"activeCourses\");\n\n                // Hide loader.\n                common.loader.hide('#activecoursesblock');\n            });\n        } else {\n            notifyListner(\"activeCourses\");\n        }\n\n        /**\n         * Create active course table.\n         * @param {object} data Table data object\n         */\n        function createActiveCourseTable(data) {\n            /* If datable already created the destroy the table*/\n            if (activeCourseTable) {\n                activeCourseTable.destroy();\n            }\n\n            /* Create datatable for active courses */\n            activeCourseTable = $(table).DataTable({\n                responsive: true,\n                data: data,\n                aaSorting: [[2, 'desc']],\n                aoColumns: [\n                    null,\n                    null,\n                    {\"orderSequence\": [\"desc\"]},\n                    {\"orderSequence\": [\"desc\"]},\n                    {\"orderSequence\": [\"desc\"]}\n                ],\n                language: {\n                    searchPlaceholder: \"Search Course\"\n                },\n                initComplete: function() {\n                    /* Remove laoder and display table after table is created */\n                    $(loader).hide();\n                    $(table).fadeIn(\"slow\");\n                },\n                drawCallback: function() {\n                    $('.dataTables_paginate > .pagination').addClass('pagination-sm pull-right');\n                    $('.dataTables_filter').addClass('pagination-sm pull-right');\n                },\n                columnDefs: [\n                    {\n                        \"targets\": 0,\n                        \"className\": \"text-center\",\n                        \"orderable\": false\n                    },\n                    {\n                        \"targets\": 1,\n                        \"className\": \"text-left\",\n                        \"orderable\": false\n                    },\n                    {\n                        \"targets\": \"_all\",\n                        \"className\": \"text-center\",\n                    }\n                ],\n                lengthChange: false,\n                bInfo: false\n            });\n        }\n    }\n\n    // Must return the init function\n    return {\n        init: init\n    };\n});\n"],"file":"block_activecourses.min.js"}
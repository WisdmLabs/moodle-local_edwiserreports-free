"use strict";define(["jquery","./chart/apexcharts","./common","./defaultconfig","./select2"],function(e,t,a,o){var n=null,r=null,i={date:"weekly"},l={series:[],chart:{type:"area",height:350,dropShadow:{enabled:!0,color:"#000",top:18,left:7,blur:10,opacity:.2},toolbar:{show:!1,tools:{download:!1,reset:'<i class="fa fa-refresh"></i>'}},zoom:{enabled:!1}},tooltip:{enabled:!0,enabledOnSeries:void 0,shared:!0,followCursor:!1,intersect:!1,inverseOrder:!1,fillSeriesColor:!1,onDatasetHover:{highlightDataSeries:!1},items:{display:"flex"},fixed:{enabled:!1,position:"topRight",offsetX:0,offsetY:0},y:{title:{}}},stroke:{curve:"smooth"},grid:{borderColor:"#e7e7e7"},markers:{size:1},xaxis:{categories:null,type:"datetime",labels:{hideOverlappingLabels:!0,datetimeFormatter:{year:"yyyy",month:"MMM 'yy",day:"dd MMM",hour:""}},tooltip:{enabled:!1}},legend:{position:"top",floating:!0},dataLabels:{enabled:!1},colors:[o.getColorPalette()[2]]},s={chart:{type:"pie",height:350},legend:{position:"bottom",offsetY:0},noData:{text:M.util.get_string("nographdata","local_edwiserreports")},theme:{monochrome:{enabled:!0,color:o.getColorPalette()[2],shadeTo:"light",shadeIntensity:.65}}},d={PANEL:"#learnertimespentonsiteblock",DATE:".learnertimespentonsite-calendar",DATEMENU:".learnertimespentonsite-calendar + .dropdown-menu",DATEITEM:".learnertimespentonsite-calendar + .dropdown-menu .dropdown-item",DATEPICKER:".learnertimespentonsite-calendar + .dropdown-menu .dropdown-calendar",DATEPICKERINPUT:".learnertimespentonsite-calendar + .dropdown-menu .flatpickr",GRAPH:"#apex-chart-learnertimespentonsite-block"},c={GET_TIMESPENTONSITE:function(t){return e.ajax({url:o.requestUrl,type:o.requestType,dataType:o.requestDataType,data:{action:"get_learnertimespentonsite_graph_data_ajax",secret:M.local_edwiserreports.secret,data:JSON.stringify({filter:t})}})}};function E(){var o;a.loader.show(d.PANEL),c.GET_TIMESPENTONSITE(i).done(function(n){i.date.includes("to")||-1!==["weekly","monthly","yearly"].indexOf(i.date)?((o=Object.assign({},l)).yaxis={labels:{formatter:a.timeFormatter}},o.xaxis.categories=n.labels,o.series=[{name:M.util.get_string("timespentonlms","local_edwiserreports"),data:n.timespent}],o.chart.toolbar.show=n.labels.length>30,o.chart.zoom.enabled=n.labels.length>30,o.tooltip.y.title.formatter=function(e){return M.util.get_string("time","local_edwiserreports")+": "}):((o=Object.assign({},s)).labels=n.labels,o.series=n.timespent,o.tooltip={y:{formatter:a.timeFormatter}},o.legend={show:!1}),function(e,o){null!==r&&r.destroy(),(r=new t(e.get(0),o)).render(),setTimeout(function(){a.loader.hide(d.PANEL)},1e3)}(e(d.PANEL).find(d.GRAPH),o),a.loader.hide(d.PANEL)}).fail(function(e){a.loader.hide(d.PANEL)})}function m(){e("body").on("click",d.DATEITEM+":not(.custom)",function(){e(this).closest(d.FILTERS).data("id");e(d.PANEL).find(d.DATEITEM).removeClass("active"),e(this).addClass("active"),e(d.PANEL).find(d.DATE).html(e(this).text()),n.clear(),i.date=e(this).data("value"),E()}),n=e(d.PANEL).find(d.DATEPICKERINPUT).flatpickr({mode:"range",altInput:!0,altFormat:"d/m/Y",dateFormat:"Y-m-d",maxDate:"today",appendTo:e(d.PANEL).find(d.DATEPICKER).get(0),onOpen:function(){e(d.PANEL).find(d.DATEMENU).addClass("withcalendar")},onClose:function(){var t,a;e(d.PANEL).find(d.DATEMENU).removeClass("withcalendar"),t=e(d.PANEL).find(d.DATEPICKERINPUT).val(),a=e(d.PANEL).find(d.DATEPICKERINPUT).next().val(),e(d.PANEL).find(d.DATEITEM).removeClass("active"),e(d.PANEL).find(d.DATEITEM+".custom").addClass("active"),e(d.PANEL).find(d.DATE).html(a),i.date=t,E()}})}return{init:function(t){0!=e(d.PANEL).length&&(m(),E())}}});
//# sourceMappingURL=block_learnertimespentonsite.min.js.map

"use strict";define(["jquery","./chart/apexcharts","./common","./defaultconfig","./select2"],function(e,t,n,l){let a="rtl"==e("html").attr("dir")?1:0;var r=null,s=a?"left":"right";const i={chart:{type:"donut",height:350},fill:{type:"solid"},legend:{position:s,formatter:function(e,t){return[e+": "+t.w.globals.series[t.seriesIndex]]}},colors:l.getColorTheme(),dataLabels:{enabled:!1},noData:{text:M.util.get_string("nographdata","local_edwiserreports")}};var o={PANEL:"#gradeblock",GRAPH:".graph",GRAPHLABEL:".graph-label"},d={GET_GRAPH_DATA:function(){return e.ajax({url:l.requestUrl,type:l.requestType,dataType:l.requestDataType,data:{action:"get_grade_graph_data_ajax",secret:M.local_edwiserreports.secret,lang:e("html").attr("lang")}})}};function c(){let l;n.loader.show(o.PANEL),d.GET_GRAPH_DATA().done(function(a){(l=Object.assign({},i)).legend.position=s,l.labels=a.labels.reverse(),l.series=a.grades.reverse(),e(o.PANEL).find(o.GRAPH).data("responseTitle",a.header),l.responseTitle=a.header,l.tooltip={custom:function(e){let{series:t,seriesIndex:n,dataPointIndex:l,w:r}=e,s=t[n],i=s<2?a.tooltip.single:a.tooltip.plural,o=r.config.labels[n];return`<div class="custom-donut-tooltip" style="color: ${r.config.colors[n]};">\n                                <span style="font-weight: 500;"> ${o}:</span>\n                                <span style="font-weight: 700;"> ${s} ${M.util.get_string(i,"local_edwiserreports")}</span>\n                            </div>`}},e(o.PANEL).find(o.GRAPH).toggleClass("empty-donut",0==l.labels.length),l.chart.events={mounted:function(){e(o.PANEL).find(o.GRAPH).find(".apexcharts-legend").prepend(`<label class="graph-label w-100 text-center">\n                            ${e(o.PANEL).find(o.GRAPH).data("responseTitle")}</label>`)}},l.chart.events.updated=l.chart.events.mounted,n.insight("#gradeblock .insight",{insight:{value:a.average+"%",title:"averagegrade"}}),function(e,l){null!==r&&r.destroy(),(r=new t(e.get(0),l)).render(),setTimeout(function(){n.loader.hide(o.PANEL)},1e3)}(e(o.PANEL).find(o.GRAPH),l)}),n.loader.hide(o.PANEL)}return{init:function(t){0!=e(o.PANEL).length&&(e(o.PANEL).find(".singleselect").select2(),n.handleFilterSize(o.PANEL),setInterval(function(){if(null===r)return;let t=e(o.PANEL).find(o.GRAPH).width()>=400?a?"left":"right":"bottom";t!=s&&(s=t,r.updateOptions({legend:{position:s}}))},1e3),c())}}});
//# sourceMappingURL=block_grade.min.js.map

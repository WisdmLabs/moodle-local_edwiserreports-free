"use strict";define(["jquery","core/ajax","core/templates","./chart/apexcharts","./common","./defaultconfig","./select2"],function(e,t,n,a,r,l){var o=null,s="right",i={chart:{type:"donut",height:350},fill:{type:"solid"},legend:{position:s,formatter:function(e,t){return[e+": "+t.w.globals.series[t.seriesIndex]]}},colors:l.getColorTheme(),dataLabels:{enabled:!1},noData:{text:M.util.get_string("nographdata","local_edwiserreports")}},d={PANEL:"#gradeblock",GRAPH:".graph",GRAPHLABEL:".graph-label"},c={GET_GRAPH_DATA:function(){return e.ajax({url:l.requestUrl,type:l.requestType,dataType:l.requestDataType,data:{action:"get_grade_graph_data_ajax",secret:M.local_edwiserreports.secret,lang:e("html").attr("lang")}})}};function g(){var t;r.loader.show(d.PANEL),c.GET_GRAPH_DATA().done(function(n){(t=Object.assign({},i)).legend.position=s,t.labels=n.labels.reverse(),t.series=n.grades.reverse(),e(d.PANEL).find(d.GRAPH).data("responseTitle",n.header),t.responseTitle=n.header,t.tooltip={custom:function(e){var t=e.series,a=e.seriesIndex,r=(e.dataPointIndex,e.w),l=t[a],o=l<2?n.tooltip.single:n.tooltip.plural,s=r.config.labels[a],i=r.config.colors[a];return'<div class="custom-donut-tooltip" style="color: '.concat(i,';">\n                                <span style="font-weight: 500;"> ').concat(s,':</span>\n                                <span style="font-weight: 700;"> ').concat(l," ").concat(M.util.get_string(o,"local_edwiserreports"),"</span>\n                            </div>")}},e(d.PANEL).find(d.GRAPH).toggleClass("empty-donut",0==t.labels.length),t.chart.events={mounted:function(){e(d.PANEL).find(d.GRAPH).find(".apexcharts-legend").prepend('<label class="graph-label w-100 text-center">\n                            '.concat(e(d.PANEL).find(d.GRAPH).data("responseTitle"),"</label>"))}},t.chart.events.updated=t.chart.events.mounted,r.insight("#gradeblock .insight",{insight:{value:n.average+"%",title:"averagegrade"}}),function(e,t){null!==o&&o.destroy(),(o=new a(e.get(0),t)).render(),setTimeout(function(){r.loader.hide(d.PANEL)},1e3)}(e(d.PANEL).find(d.GRAPH),t)}),r.loader.hide(d.PANEL)}return{init:function(t){0!=e(d.PANEL).length&&(e(d.PANEL).find(".singleselect").select2(),setInterval(function(){if(null!==o){var t=e(d.PANEL).find(d.GRAPH).width()>=400?"right":"bottom";t!=s&&(s=t,o.updateOptions({legend:{position:s}}))}},1e3),g())}}});
//# sourceMappingURL=block_grade.min.js.map

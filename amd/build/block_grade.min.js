"use strict";define(["jquery","core/ajax","core/templates","./chart/apexcharts","./common","./defaultconfig","./select2"],function(e,t,a,n,r,s){var o=null,l={chart:{type:"donut",height:350},fill:{type:"solid"},legend:{position:"right",formatter:function(e,t){return[e," - ",t.w.globals.series[t.seriesIndex]]}},colors:s.getColorTheme(),dataLabels:{enabled:!1},noData:{text:M.util.get_string("nographdata","local_edwiserreports")}},i={PANEL:"#gradeblock",GRAPH:".graph",GRAPHLABEL:".graph-label"},c={GET_GRAPH_DATA:function(){return e.ajax({url:s.requestUrl,type:s.requestType,dataType:s.requestDataType,data:{action:"get_grade_graph_data_ajax",secret:M.local_edwiserreports.secret}})}};function d(){var t;r.loader.show(i.PANEL),c.GET_GRAPH_DATA().done(function(a){(t=Object.assign({},l)).labels=a.labels.reverse(),t.series=a.grades.reverse(),e(i.PANEL).find(i.GRAPH).data("responseTitle",a.header),t.responseTitle=a.header,t.tooltip={custom:function(e){var t=e.series,n=e.seriesIndex,r=(e.dataPointIndex,e.w),s=t[n],o=s<2?a.tooltip.single:a.tooltip.plural,l=r.config.labels[n],i=r.config.colors[n];return'<div class="custom-donut-tooltip" style="color: '.concat(i,';">\n                                <span style="font-weight: 500;"> ').concat(l,':</span>\n                                <span style="font-weight: 700;"> ').concat(s," ").concat(o,"</span>\n                            </div>")}},t.chart.events={mounted:function(){e(i.PANEL).find(i.GRAPH).find(".apexcharts-legend").prepend('<label class="graph-label h4 w-100 text-center">'.concat(e(i.PANEL).find(i.GRAPH).data("responseTitle"),"</label>"))}},t.chart.events.updated=t.chart.events.mounted,r.insight("#gradeblock .insight",{insight:{value:a.average+"%",title:M.util.get_string("averagegrade","local_edwiserreports")}}),function(e,t){null!==o&&o.destroy(),(o=new n(e.get(0),t)).render(),setTimeout(function(){r.loader.hide(i.PANEL)},1e3)}(e(i.PANEL).find(i.GRAPH),t)}),r.loader.hide(i.PANEL)}return{init:function(t){0!=e(i.PANEL).length&&(e(i.PANEL).find(".singleselect").select2(),d())}}});
//# sourceMappingURL=block_grade.min.js.map

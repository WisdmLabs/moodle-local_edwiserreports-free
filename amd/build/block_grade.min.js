"use strict";define(["jquery","./chart/apexcharts","./common","./defaultconfig","./select2"],function(e,t,n,a){var r=null,l="right",o={chart:{type:"donut",height:350},fill:{type:"solid"},legend:{position:l,formatter:function(e,t){return[e+": "+t.w.globals.series[t.seriesIndex]]}},colors:a.getColorTheme(),dataLabels:{enabled:!1},noData:{text:M.util.get_string("nographdata","local_edwiserreports")}},s={PANEL:"#gradeblock",GRAPH:".graph",GRAPHLABEL:".graph-label"},i={GET_GRAPH_DATA:function(){return e.ajax({url:a.requestUrl,type:a.requestType,dataType:a.requestDataType,data:{action:"get_grade_graph_data_ajax",secret:M.local_edwiserreports.secret,lang:e("html").attr("lang")}})}};function d(){var a;n.loader.show(s.PANEL),i.GET_GRAPH_DATA().done(function(i){(a=Object.assign({},o)).legend.position=l,a.labels=i.labels.reverse(),a.series=i.grades.reverse(),e(s.PANEL).find(s.GRAPH).data("responseTitle",i.header),a.responseTitle=i.header,a.tooltip={custom:function(e){var t=e.series,n=e.seriesIndex,a=(e.dataPointIndex,e.w),r=t[n],l=r<2?i.tooltip.single:i.tooltip.plural,o=a.config.labels[n],s=a.config.colors[n];return'<div class="custom-donut-tooltip" style="color: '.concat(s,';">\n                                <span style="font-weight: 500;"> ').concat(o,':</span>\n                                <span style="font-weight: 700;"> ').concat(r," ").concat(M.util.get_string(l,"local_edwiserreports"),"</span>\n                            </div>")}},e(s.PANEL).find(s.GRAPH).toggleClass("empty-donut",0==a.labels.length),a.chart.events={mounted:function(){e(s.PANEL).find(s.GRAPH).find(".apexcharts-legend").prepend('<label class="graph-label w-100 text-center">\n                            '.concat(e(s.PANEL).find(s.GRAPH).data("responseTitle"),"</label>"))}},a.chart.events.updated=a.chart.events.mounted,n.insight("#gradeblock .insight",{insight:{value:i.average+"%",title:"averagegrade"}}),function(e,a){null!==r&&r.destroy(),(r=new t(e.get(0),a)).render(),setTimeout(function(){n.loader.hide(s.PANEL)},1e3)}(e(s.PANEL).find(s.GRAPH),a)}),n.loader.hide(s.PANEL)}return{init:function(t){0!=e(s.PANEL).length&&(e(s.PANEL).find(".singleselect").select2(),n.handleFilterSize(s.PANEL),setInterval(function(){if(null!==r){var t=e(s.PANEL).find(s.GRAPH).width()>=400?"right":"bottom";t!=l&&(l=t,r.updateOptions({legend:{position:l}}))}},1e3),d())}}});
//# sourceMappingURL=block_grade.min.js.map

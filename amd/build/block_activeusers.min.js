"use strict";
define(["jquery", "./chart/apexcharts", "core/notification", "./defaultconfig", "./common", "./flatpickr"], function(e, a, t, r, o) { var l = null,
        s = null,
        i = r.getPanel("#activeusersblock", "body"),
        n = r.getPanel("#activeusersblock", "footer"),
        c = i + " .ct-chart",
        d = i + " .loader",
        h = i + " .refresh",
        p = "weekly",
        u = null,
        f = { series: [], chart: { type: "area", height: 350, dropShadow: { enabled: !0, color: "#000", top: 18, left: 7, blur: 10, opacity: .2 }, toolbar: { show: !1, tools: { download: !1, reset: '<i class="fa fa-refresh"></i>' } }, zoom: { enabled: !1 } }, tooltip: { enabled: !0, enabledOnSeries: void 0, shared: !0, followCursor: !1, intersect: !1, inverseOrder: !1, fillSeriesColor: !1, onDatasetHover: { highlightDataSeries: !1 }, y: { formatter: void 0, title: {} }, items: { display: "flex" }, fixed: { enabled: !1, position: "topRight", offsetX: 0, offsetY: 0 } }, stroke: { curve: "smooth" }, grid: { borderColor: "#e7e7e7" }, markers: { size: 1 }, xaxis: { categories: null, type: "datetime", labels: { hideOverlappingLabels: !0, datetimeFormatter: { year: "yyyy", month: "MMM 'yy", day: "dd MMM", hour: "" } }, tooltip: { enabled: !1 } }, legend: { position: "top", floating: !0 }, colors: r.getColorTheme(), dataLabels: { enabled: !1 } }; return { init: function(g) {
            function m() { e(c).hide(), e(d).show(), o.loader.show("#activeusersblock"), e.ajax({ url: r.requestUrl, type: r.requestType, dataType: r.requestDataType, data: { action: "get_activeusers_graph_data_ajax", secret: M.local_edwiserreports.secret, data: JSON.stringify({ precalculated: -1 !== ["weekly", "monthly", "yearly"].indexOf(p), filter: p, graphajax: !0 }) } }).done(function(e) {!0 !== e.error || "invalidsecretkey" !== e.exception.errorcode ? (l.graph.data = e.data, l.graph.labels = e.labels, o.insight("#activeusersblock .insight", e.insight)) : g("activeusersblock", e) }).fail(function(e) { t.exception(e) }).always(function() { s && s.destroy(), (s = new a(e("#apex-chart-active-users").get(0), function() { var e = Object.assign({}, f); try { e.series = [{ name: l.graph.labelName.activeUsers, data: l.graph.data.activeUsers }, { name: l.graph.labelName.enrolments, data: l.graph.data.enrolments }, { name: l.graph.labelName.completionRate, data: l.graph.data.completionRate }], e.xaxis.categories = l.graph.labels, e.chart.toolbar.show = l.graph.labels.length > 30, e.chart.zoom.enabled = l.graph.labels.length > 30 } catch (a) { e.series = [], e.xaxis.categories = [], e.chart.toolbar.show = !1, e.chart.zoom.enabled = !1 } return e }())).render(), s = s, e(n).find('.download-links input[name="filter"]').val(p), e(i + " #updated-time > span.minute").html(0), clearInterval(u), u = setInterval(b, 6e4), e(h).removeClass("refresh-spin"), e(d).hide(), e(c).fadeIn("slow"), o.loader.hide("#activeusersblock") }) }

            function b() { e(i + " #updated-time > span.minute").html(parseInt(e(i + " #updated-time > span.minute").text()) + 1) }(l = r.getActiveUsersBlock()) && (e(h).on("click", function() { e(this).addClass("refresh-spin"), m() }), o.dateChange(function(e) { p = e, m() }), m()) } } });
//# sourceMappingURL=block_activeusers.min.js.map
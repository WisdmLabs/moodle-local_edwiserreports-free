"use strict";define(["local_edwiserreports/jquery","./common","./insights","./defaultconfig","./block_siteaccess","./block_activecourses","./block_activeusers","./block_courseprogress","./block_courseengagement","./block_inactiveusers","./block_realtimeusers","./block_todaysactivity","./block_grade","./block_visitsonsite","./block_timespentonsite","./block_timespentoncourse","./block_courseactivitystatus","./block_learnercourseprogress","./block_learnertimespentonsite"],function(e,t,a,n,o,r,l,i,c,s,d,E,u,T,p,m,g,D,h){var A={GET_TIMEPERIOD_LABEL:function(t){return e.ajax({url:n.requestUrl,type:n.requestType,dataType:n.requestDataType,data:{action:"get_timeperiod_label_data_ajax",secret:M.local_edwiserreports.secret,lang:e("html").attr("lang"),data:t}})}},I={ROOT:"#wdm-edwiserreports",DATESELECTED:".selected-period",DATE:".edwiserreports-calendar",DATEMENU:".edwiserreports-calendar + .dropdown-menu",DATEITEM:".edwiserreports-calendar + .dropdown-menu .dropdown-item",DATEPICKER:".edwiserreports-calendar + .dropdown-menu .dropdown-calendar",DATEPICKERINPUT:".edwiserreports-calendar + .dropdown-menu .flatpickr"},f=[o,r,l,i,c,s,d,E,u,T,p,m,g,D,h];let v=null;function _(t,a){e(`#${t} .panel-body`).html(a.exception.message)}function w(t){A.GET_TIMEPERIOD_LABEL(t).done(function(t){let a=new Date(864e5*t.startdate),n=new Date(864e5*t.enddate),o=a.getDate();o=o<10?"0"+o:o;let r=n.getDate();r=r<10?"0"+r:r;let l=`${o} ${a.toLocaleString("default",{month:"long"})} ${a.getFullYear()}`+" - "+`${r} ${n.toLocaleString("default",{month:"long"})} ${n.getFullYear()}`;"rtl"==e("html").attr("dir")&&(a=a.getFullYear()+" "+a.toLocaleString("default",{month:"long"})+" "+o,l=(n=n.getFullYear()+" "+n.toLocaleString("default",{month:"long"})+" "+r)+"-"+a,e(I.DATE).css({direction:"ltr","text-align":"right"}),e(I.DATEPICKERINPUT).css({direction:"ltr","text-align":"right"})),e(I.DATESELECTED).html(l)}).fail(function(e){Notification.exception(e)})}function C(e,t){let a=new CustomEvent("edwiserreport:datechange",{detail:{date:e}});document.dispatchEvent(a),w(e)}return{init:function(){e(document).ready(function(){a.init(),w(e(I.DATEITEM+".active").data("value"),e(I.DATEITEM+".active").text()),t.handleSearchInput(),e(".singleselect").each(function(t,a){e(a).val(e(a).find("option:nth-child(1)").val())}),f.forEach(e=>{e.init(_)}),v=e(I.DATEPICKERINPUT).flatpickr({mode:"range",altInput:!0,altFormat:"d M Y",dateFormat:"Y-m-d",maxDate:"today",appendTo:e(I.DATEPICKER).get(0),onOpen:function(){e(I.DATEMENU).addClass("withcalendar"),e(I.DATE).dropdown("update")},onClose:function(){e(I.DATEMENU).removeClass("withcalendar"),function(){let t=e(I.DATEPICKERINPUT).val(),a=e(I.DATEPICKERINPUT).next().val().replace("to","-"),n=e("html").attr("dir"),o=a.split("-");if("rtl"==n){let t=o[0].split(" "),n=o[1].split(" ");t=t[2]+" "+t[1]+" "+t[0],a=(n=n[3]+" "+n[2]+" "+n[1])+"-"+t,e(I.DATE).css({direction:"ltr","text-align":"right"}),e(I.DATEPICKERINPUT).css({direction:"ltr","text-align":"right"})}e(I.DATEPICKERINPUT).next().val(a),t.includes(" to ")?(e(I.DATEITEM).removeClass("active"),e(I.DATEITEM+".custom").addClass("active"),e(I.DATE).html(a),C(t)):v.clear()}()}}),e("body").on("click",I.DATEITEM+":not(.custom)",function(){e(I.DATEITEM).removeClass("active"),e(this).addClass("active"),e(I.DATE).html(e(this).text()),v.clear(),C(e(this).data("value"),e(this).text())})})}}});
//# sourceMappingURL=main.min.js.map
